$(function(){var a="http://47.94.209.159:8080";$("#searchBtn").click(function(){$("#titleBar").attr("hidden",true);$("#keywordInput").attr("hidden",false)});$("#cancle").click(function(){$("#titleBar").attr("hidden",false);$("#keywordInput").attr("hidden",true)});$.ajax({type:"POST",url:a+"/data/query",headers:{"Content-type":"application/json;charset=UTF-8","Accept-Encoding":"gzip"},crossDomain:true,data:JSON.stringify({page:0,pageSize:5,filter:{source:"zhihu"},orders:[{property:"approvalNum",direction:"DESC"}]}),dataType:"JSON"}).done(function(b){appendBooks("hottestBooks",b.records,"hottestBooks")}).fail(function(){console.info("暂无数据")});$.ajax({type:"POST",url:a+"/data/query",headers:{"Content-type":"application/json;charset=UTF-8","Accept-Encoding":"gzip"},crossDomain:true,data:JSON.stringify({page:0,pageSize:5,filter:{source:"zhihu"},orders:[{property:"lastModifyTime",direction:"DESC"}]}),dataType:"JSON"}).done(function(b){appendBooks("newestBooks",b.records,"newestBooks")}).fail(function(){console.info("暂无数据")})});var appendBooks=function(c,s,u){var n="#"+u;var l=$(n);for(var r=0;r<s.length;r++){var b=s[r],w=b.title&&b.title.length>13?b.title+"...":b.title;var o='<img class="stars" src="images/star3.png">';for(k=4;k>r;k--){o+='<img class="stars" src="images/star3.png">'}var v='<li class="booklist">',q='<div class="xingji"><p>Top<span style="padding-bottom: 0rem;">'+o+"</span></p> </div>",e='<div class="daoyu"><p>'+w+"</p></div>",a='<div class="fenlei"><div class="fenlei-lf"><img src="images/tag3.png"><span>金融；入门；进阶</span></div><div class="fenlei-rg"><img src="images/fav3.png"><span class="num">15</span></div></div>';var m='<div class="content-head"'+("newestBooks"==c?'style="padding-top:12px;height:70px"':"")+">"+("newestBooks"==c?"":q)+e+a+"</div>",t='<div class="content-body">';var d='<a role="link" href="details.html?uuid='+b.uuid+'">';var g=b.books;var f=0;for(var p=0;p<g.length;p++){if(f==2){break}var h=g[p];if(h.introduction){t=t+appendBook(p,g[p],b.uuid,c,r+1);f++}else{h.introduction="暂无简介";t=t+appendBook(p,g[p],b.uuid,c,r+1);f++}}v=d+v+m+t+"</div></li></a>";l.append(v)}};var appendBook=function(g,b,a,f,d){var h=b.introduction;var e='<div class="list">',c='<div class="bookpic"><img alt="暂无书籍封面" style="width: 60px;height: 84px;'+(g==1?"float:right;":"float:left;")+'" src="'+b.picture+'"/></div>',i='<div class="bookintro"><h4 style="font-size:0.15rem">'+b.name+"</h4><p>"+h+"</p></div>";rbookintro='<div class="bookintro"><h4 style="font-size:0.15rem;text-align: -webkit-right;">'+b.name+"</h4><p>"+h+"</p></div>";if(g==0){e=e+c+i}else{if(g==1){if(f=="newestBooks"){e=e+rbookintro+c+"<div><img src='images/numberline2.png' class='bline'></div><p class='booknumber'>"+d+"</p>"}else{e=e+rbookintro+c}}}return e+"</div>"};function entersearch(){var a=window.event||arguments.callee.caller.arguments[0];if(a.keyCode==13){$.ajax({type:"POST",url:perUrl+"/data/query",headers:{"Content-type":"application/json;charset=UTF-8","Accept-Encoding":"gzip"},crossDomain:true,data:JSON.stringify({page:0,pageSize:5,filter:{keyword:$("#search").val()},orders:[{property:"lastModifyTime",direction:"DESC"}]}),dataType:"JSON"}).done(function(b){if(b.count==0){$("#books").hide();$("#banner").hide();$("#notes").append("<p class='emptytop'>暂无对应书单</p><p class='empty'>这世上居然还有比我博学之人，哼！</p>");$("#cancle").click(function(){$("#books").show();$("#banner").show();$("#notes").empty();$("#search").val("")})}else{$("#notes").empty();var c=document.getElementById("search");c.setAttribute("readOnly",true);document.getElementById("search").value="“"+$("#search").val()+"”搜索结果如下：";$("#books").hide();$("#banner").hide();$("#banner").hide();appendBooks("newestBooks",b.records,"searchresult");$("#cancle").click(function(){$("#books").show();$("#banner").show();$("#notes").empty();$("#searchresult").empty();$("#search").val("");c.removeAttribute("readOnly")})}}).fail(function(){})}};